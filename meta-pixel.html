<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Meta Pixel</title>
<link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;600;700&family=Inter:wght@300;400;500;600&display=swap" rel="stylesheet">
<style>
*{margin:0;padding:0;box-sizing:border-box}
body{font-family:'Inter',sans-serif;background:#0a0a0a;min-height:100vh;color:#fff}

.meta-blue{background:linear-gradient(135deg,#0095F6,#00d4ff,#0095F6);-webkit-background-clip:text;-webkit-text-fill-color:transparent}

.header{padding:30px 40px;display:flex;align-items:center;justify-content:space-between;border-bottom:1px solid rgba(0,149,246,0.2)}
.logo{display:flex;align-items:center;gap:20px}
.logo-icon{width:60px;height:60px;border:2px solid #0095F6;border-radius:15px;display:flex;align-items:center;justify-content:center;font-family:'Playfair Display',serif;font-size:28px;font-weight:700;color:#0095F6;background:rgba(0,149,246,0.1)}
.logo h1{font-family:'Playfair Display',serif;font-size:28px;font-weight:600;letter-spacing:1px}
.back-btn{background:transparent;border:1px solid rgba(255,255,255,0.2);color:#999;padding:14px 28px;font-size:13px;letter-spacing:1px;text-transform:uppercase;cursor:pointer;transition:all 0.4s ease}
.back-btn:hover{border-color:#0095F6;color:#0095F6}

.main{max-width:700px;margin:0 auto;padding:50px 30px}

.section-title{font-family:'Playfair Display',serif;font-size:14px;letter-spacing:3px;text-transform:uppercase;color:#0095F6;margin-bottom:25px;display:flex;align-items:center;gap:20px}
.section-title::before,.section-title::after{content:"";flex:1;height:1px;background:linear-gradient(90deg,transparent,rgba(0,149,246,0.3),transparent)}

.status-hero{text-align:center;padding:50px 30px;margin-bottom:50px;border:1px solid rgba(0,149,246,0.2);background:linear-gradient(180deg,rgba(0,149,246,0.05) 0%,transparent 100%)}
.status-icon{font-size:60px;margin-bottom:20px}
.status-title{font-family:'Playfair Display',serif;font-size:32px;font-weight:600;margin-bottom:10px;letter-spacing:2px}
.status-desc{font-size:14px;color:#666;letter-spacing:1px}

.table-wrap{margin-bottom:50px}
.table-row{display:grid;grid-template-columns:1fr 120px 1.5fr;gap:20px;padding:20px 25px;border-bottom:1px solid rgba(255,255,255,0.05);align-items:center;transition:all 0.3s}
.table-row:hover{background:rgba(0,149,246,0.03)}
.table-row:last-child{border-bottom:none}
.row-title{font-size:14px;font-weight:500;letter-spacing:0.5px}
.row-desc{font-size:12px;color:#555;letter-spacing:0.3px}

.badge{padding:6px 14px;font-size:11px;letter-spacing:1px;text-transform:uppercase;border:1px solid;background:transparent}
.badge-off{color:#ff4757;border-color:rgba(255,71,87,0.3)}
.badge-wait{color:#666;border-color:rgba(255,255,255,0.1)}
.badge-on{color:#2ed573;border-color:rgba(46,213,115,0.3)}
.badge-info{color:#0095F6;border-color:rgba(0,149,246,0.3)}

.card{border:1px solid rgba(0,149,246,0.2);padding:40px;margin-bottom:30px;background:linear-gradient(180deg,rgba(0,149,246,0.03) 0%,transparent 100%)}
.card-title{font-family:'Playfair Display',serif;font-size:18px;font-weight:600;margin-bottom:30px;letter-spacing:1px;color:#0095F6}

.input-group{margin-bottom:25px}
.input-group label{display:block;font-size:11px;letter-spacing:2px;text-transform:uppercase;color:#666;margin-bottom:12px}
.input-group label .required{color:#ff4757;margin-left:5px}
.input-group label .optional{color:#444;font-size:9px;margin-left:8px}
.input-group input{width:100%;padding:18px 20px;background:#111;border:1px solid rgba(255,255,255,0.1);color:#fff;font-size:16px;letter-spacing:1px;transition:all 0.4s}
.input-group input:focus{outline:none;border-color:#0095F6;box-shadow:0 0 30px rgba(0,149,246,0.1)}
.input-group input::placeholder{color:#333}
.input-hint{font-size:11px;color:#444;margin-top:10px;letter-spacing:0.3px;line-height:1.6}
.input-hint a{color:#0095F6;text-decoration:none}
.input-hint a:hover{text-decoration:underline}

.divider{height:1px;background:linear-gradient(90deg,transparent,rgba(0,149,246,0.3),transparent);margin:30px 0}

.toggle-item{display:flex;align-items:center;justify-content:space-between;padding:20px 0;border-bottom:1px solid rgba(255,255,255,0.05)}
.toggle-item:last-child{border-bottom:none}
.toggle-label{font-size:14px;font-weight:500}
.toggle-label span{display:block;font-size:11px;color:#555;margin-top:5px;font-weight:400}
.toggle-switch{width:50px;height:26px;background:#222;border-radius:13px;position:relative;cursor:pointer;transition:all 0.3s}
.toggle-switch::after{content:"";position:absolute;width:20px;height:20px;background:#444;border-radius:50%;top:3px;left:3px;transition:all 0.3s}
.toggle-switch.active{background:linear-gradient(90deg,#0095F6,#00d4ff)}
.toggle-switch.active::after{left:27px;background:#fff}

.event-grid{display:grid;grid-template-columns:repeat(2,1fr);gap:15px;margin-top:20px}
.event-card{padding:20px;border:1px solid rgba(255,255,255,0.1);cursor:pointer;transition:all 0.3s;user-select:none}
.event-card:hover{border-color:rgba(0,149,246,0.5)}
.event-card.active{border-color:#0095F6;background:rgba(0,149,246,0.1)}
.event-card.active .event-check{background:#0095F6;border-color:#0095F6}
.event-card.active .event-check::after{opacity:1}
.event-header{display:flex;align-items:center;gap:12px;margin-bottom:10px}
.event-check{width:20px;height:20px;border:2px solid #333;border-radius:4px;position:relative;transition:all 0.3s}
.event-check::after{content:"✓";position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);color:#fff;font-size:12px;opacity:0;transition:opacity 0.3s}
.event-name{font-size:14px;font-weight:600}
.event-desc{font-size:11px;color:#555;line-height:1.5}

.btn-row{display:flex;gap:20px;margin-top:40px}
.btn{flex:1;padding:18px;font-size:12px;letter-spacing:2px;text-transform:uppercase;border:none;cursor:pointer;transition:all 0.4s}
.btn-outline{background:transparent;border:1px solid rgba(255,255,255,0.2);color:#666}
.btn-outline:hover{border-color:#fff;color:#fff}
.btn-primary{background:linear-gradient(90deg,#0095F6,#00d4ff);color:#fff;font-weight:600}
.btn-primary:hover{box-shadow:0 10px 40px rgba(0,149,246,0.3);transform:translateY(-2px)}

.footer-link{display:block;text-align:center;margin-top:40px;font-size:12px;letter-spacing:2px;color:#444;text-decoration:none;text-transform:uppercase;transition:color 0.3s}
.footer-link:hover{color:#0095F6}

.info-banner{display:flex;align-items:flex-start;gap:20px;padding:25px 30px;border:1px solid rgba(0,149,246,0.2);background:rgba(0,149,246,0.02);margin-bottom:40px}
.info-banner-icon{font-size:28px;flex-shrink:0}
.info-banner-text{font-size:13px;color:#888;line-height:1.7;letter-spacing:0.3px}
.info-banner-text strong{color:#0095F6}

.help-box{background:rgba(0,0,0,0.3);border:1px solid rgba(255,255,255,0.05);padding:20px;margin-top:20px}
.help-box-title{font-size:12px;font-weight:600;color:#0095F6;margin-bottom:12px;letter-spacing:1px}
.help-box ol{font-size:12px;color:#666;line-height:2;padding-left:20px}
.help-box ol a{color:#0095F6}

.toast{position:fixed;bottom:40px;left:50%;transform:translateX(-50%) translateY(100px);background:linear-gradient(90deg,#0095F6,#00d4ff);color:#fff;padding:16px 40px;font-size:12px;letter-spacing:2px;text-transform:uppercase;font-weight:600;transition:transform 0.5s cubic-bezier(0.68,-0.55,0.265,1.55);z-index:1000}
.toast.show{transform:translateX(-50%) translateY(0)}

@media(max-width:600px){
.header{padding:20px;flex-direction:column;gap:20px}
.main{padding:30px 20px}
.table-row{grid-template-columns:1fr 100px}
.row-desc{display:none}
.btn-row{flex-direction:column}
.card{padding:25px}
.event-grid{grid-template-columns:1fr}
}
</style>
</head>
<body>

<header class="header">
<div class="logo">
<div class="logo-icon">M</div>
<h1 class="meta-blue">Meta Pixel</h1>
</div>
<button class="back-btn" onclick="location.href='ana-sayfa.html'">← Geri Dön</button>
</header>

<main class="main">

<!-- DURUM HERO -->
<div class="status-hero" id="statusHero">
<div class="status-icon" id="statusIcon">📊</div>
<h2 class="status-title meta-blue" id="statusTitle">Pixel Pasif</h2>
<p class="status-desc" id="statusDesc">Yapılandırma bekleniyor</p>
</div>

<!-- BİLGİ BANNER -->
<div class="info-banner">
<div class="info-banner-icon">💡</div>
<div class="info-banner-text">
<strong>Meta Pixel Nedir?</strong><br>
Web sitenizdeki ziyaretçi davranışlarını takip eder. Facebook ve Instagram reklamlarınızı optimize etmenizi sağlar. Pixel ID girip aktif ettiğinizde veriler Meta'ya gönderilmeye başlar.
</div>
</div>

<!-- PIXEL DURUMU -->
<div class="section-title">Sistem Durumu</div>
<div class="table-wrap">
<div class="table-row">
<div class="row-title">Pixel ID</div>
<div><span class="badge badge-off" id="badgePixelId">Girilmedi</span></div>
<div class="row-desc">15-16 haneli benzersiz kod</div>
</div>
<div class="table-row">
<div class="row-title">Pixel Durumu</div>
<div><span class="badge badge-off" id="badgePixelActive">Pasif</span></div>
<div class="row-desc">Veri toplama durumu</div>
</div>
<div class="table-row">
<div class="row-title">Test Modu</div>
<div><span class="badge badge-off" id="badgeTestMode">Kapalı</span></div>
<div class="row-desc">Events Manager'da test görünümü</div>
</div>
<div class="table-row">
<div class="row-title">Aktif Eventler</div>
<div><span class="badge badge-wait" id="badgeEvents">0 Event</span></div>
<div class="row-desc">Takip edilen kullanıcı aksiyonları</div>
</div>
<div class="table-row">
<div class="row-title">Conversions API</div>
<div><span class="badge badge-wait" id="badgeAPI">Opsiyonel</span></div>
<div class="row-desc">Gelişmiş sunucu taraflı takip</div>
</div>
</div>

<!-- PIXEL AYARLARI -->
<div class="card">
<h3 class="card-title">Pixel Yapılandırması</h3>

<div class="input-group">
<label>Meta Pixel ID <span class="required">*</span></label>
<input type="text" id="pixelId" placeholder="123456789012345" maxlength="16" oninput="updateStatus()">
<div class="input-hint">
Meta Events Manager'dan alınan 15-16 haneli benzersiz kod.<br>
<a href="https://business.facebook.com/events_manager" target="_blank">Events Manager'ı Aç →</a>
</div>
</div>

<div class="help-box">
<div class="help-box-title">Pixel ID Nasıl Alınır?</div>
<ol>
<li><a href="https://business.facebook.com/events_manager" target="_blank">Meta Events Manager</a>'a git</li>
<li>Sol menüden "Data Sources" seç</li>
<li>Pixel'ini seç veya yeni oluştur</li>
<li>Pixel ID'yi kopyala (15-16 haneli numara)</li>
</ol>
</div>

<div class="divider"></div>

<div class="input-group">
<label>Access Token <span class="optional">(Opsiyonel - Conversions API)</span></label>
<input type="text" id="accessToken" placeholder="EAAxxxxxxx...">
<div class="input-hint">
iOS14+ sonrası daha doğru takip için Conversions API kullanılır. Zorunlu değil, temel takip için Pixel ID yeterli.
</div>
</div>

<div class="input-group">
<label>Test Event Code <span class="optional">(Opsiyonel)</span></label>
<input type="text" id="testCode" placeholder="TEST12345">
<div class="input-hint">
Events Manager → Test Events bölümünden alınır. Test modunda eventleri görmek için kullanılır.
</div>
</div>

<div class="divider"></div>

<div class="toggle-item">
<div class="toggle-label">Pixel Aktif<span>Veri toplamayı başlat</span></div>
<div class="toggle-switch" id="switchActive" onclick="toggleSwitch('active')"></div>
</div>

<div class="toggle-item">
<div class="toggle-label">Test Modu<span>Canlıya almadan önce Events Manager'da test et</span></div>
<div class="toggle-switch" id="switchTest" onclick="toggleSwitch('test')"></div>
</div>
</div>

<!-- EVENTLER -->
<div class="card">
<h3 class="card-title">Takip Edilecek Eventler</h3>
<p style="font-size:12px;color:#666;margin-bottom:20px;line-height:1.6">Hangi kullanıcı aksiyonlarını takip etmek istediğinizi seçin. Seçilen eventler ürün sayfalarında otomatik tetiklenir.</p>

<div class="event-grid">
<div class="event-card" data-event="PageView" onclick="toggleEvent(this)">
<div class="event-header">
<div class="event-check"></div>
<div class="event-name">PageView</div>
</div>
<div class="event-desc">Sayfa görüntülendiğinde tetiklenir. Tüm ziyaretçileri takip eder.</div>
</div>

<div class="event-card" data-event="ViewContent" onclick="toggleEvent(this)">
<div class="event-header">
<div class="event-check"></div>
<div class="event-name">ViewContent</div>
</div>
<div class="event-desc">Ürün sayfası görüntülendiğinde. Ürün ilgisini ölçer.</div>
</div>

<div class="event-card" data-event="Lead" onclick="toggleEvent(this)">
<div class="event-header">
<div class="event-check"></div>
<div class="event-name">Lead</div>
</div>
<div class="event-desc">Sipariş formu gönderildiğinde. Potansiyel müşterileri yakalar.</div>
</div>

<div class="event-card" data-event="Purchase" onclick="toggleEvent(this)">
<div class="event-header">
<div class="event-check"></div>
<div class="event-name">Purchase</div>
</div>
<div class="event-desc">Satın alma tamamlandığında. Dönüşümleri ölçer.</div>
</div>
</div>
</div>

<!-- BUTONLAR -->
<div class="btn-row">
<button class="btn btn-outline" onclick="resetAll()">Sıfırla</button>
<button class="btn btn-primary" onclick="saveAll()">Kaydet</button>
</div>

<a href="https://business.facebook.com/events_manager" target="_blank" class="footer-link">Meta Events Manager →</a>

</main>

<div class="toast" id="toast"></div>

<!-- Meta Pixel Code -->
<script>
!function(f,b,e,v,n,t,s)
{if(f.fbq)return;n=f.fbq=function(){n.callMethod?
n.callMethod.apply(n,arguments):n.queue.push(arguments)};
if(!f._fbq)f._fbq=n;n.push=n;n.loaded=!0;n.version='2.0';
n.queue=[];t=b.createElement(e);t.async=!0;
t.src=v;s=b.getElementsByTagName(e)[0];
s.parentNode.insertBefore(t,s)}(window, document,'script',
'https://connect.facebook.net/en_US/fbevents.js');
</script>

<script>
var settings = {
pixelId: '',
accessToken: '',
testCode: '',
active: false,
testMode: false,
events: []
};

window.onload = function(){
loadSettings();
};

function loadSettings(){
var saved = localStorage.getItem('meta_pixel_settings');
if(saved){
settings = JSON.parse(saved);
document.getElementById('pixelId').value = settings.pixelId || '';
document.getElementById('accessToken').value = settings.accessToken || '';
document.getElementById('testCode').value = settings.testCode || '';

if(settings.active) document.getElementById('switchActive').classList.add('active');
if(settings.testMode) document.getElementById('switchTest').classList.add('active');

var cards = document.querySelectorAll('.event-card');
cards.forEach(function(card){
if(settings.events.indexOf(card.dataset.event) > -1){
card.classList.add('active');
}
});
}
updateStatus();
initializeMetaPixel();
}

function initializeMetaPixel(){
if(settings.pixelId && settings.active){
// Meta Pixel'i başlat
fbq('init', settings.pixelId);

// Test modu varsa test code ekle
if(settings.testMode && settings.testCode){
fbq('init', settings.pixelId, {}, {
agent: 'test_' + settings.testCode
});
}

// PageView otomatik gönder
fbq('track', 'PageView');
console.log('Meta Pixel initialized with ID:', settings.pixelId);
}
}

function toggleSwitch(type){
var el = document.getElementById('switch' + type.charAt(0).toUpperCase() + type.slice(1));
el.classList.toggle('active');

if(type === 'active') settings.active = el.classList.contains('active');
if(type === 'test') settings.testMode = el.classList.contains('active');

updateStatus();
}

function toggleEvent(el){
el.classList.toggle('active');
var ev = el.dataset.event;
var idx = settings.events.indexOf(ev);
if(idx > -1){
settings.events.splice(idx, 1);
}else{
settings.events.push(ev);
}
updateStatus();
}

function updateStatus(){
var pixelId = document.getElementById('pixelId').value.trim();
var accessToken = document.getElementById('accessToken').value.trim();
settings.pixelId = pixelId;
settings.accessToken = accessToken;

// Badge'leri güncelle
var badgePixelId = document.getElementById('badgePixelId');
var badgePixelActive = document.getElementById('badgePixelActive');
var badgeTestMode = document.getElementById('badgeTestMode');
var badgeEvents = document.getElementById('badgeEvents');
var badgeAPI = document.getElementById('badgeAPI');

// Pixel ID
if(pixelId && pixelId.length >= 15){
badgePixelId.className = 'badge badge-on';
badgePixelId.textContent = 'Girildi ✓';
}else if(pixelId){
badgePixelId.className = 'badge badge-info';
badgePixelId.textContent = 'Eksik';
}else{
badgePixelId.className = 'badge badge-off';
badgePixelId.textContent = 'Girilmedi';
}

// Pixel Active
if(settings.active && pixelId && pixelId.length >= 15){
badgePixelActive.className = 'badge badge-on';
badgePixelActive.textContent = 'Aktif ✓';
}else{
badgePixelActive.className = 'badge badge-off';
badgePixelActive.textContent = 'Pasif';
}

// Test Mode
if(settings.testMode){
badgeTestMode.className = 'badge badge-info';
badgeTestMode.textContent = 'Açık';
}else{
badgeTestMode.className = 'badge badge-off';
badgeTestMode.textContent = 'Kapalı';
}

// Events
var eventCount = settings.events.length;
if(eventCount > 0){
badgeEvents.className = 'badge badge-on';
badgeEvents.textContent = eventCount + ' Event ✓';
}else{
badgeEvents.className = 'badge badge-wait';
badgeEvents.textContent = '0 Event';
}

// Conversions API
if(accessToken){
badgeAPI.className = 'badge badge-on';
badgeAPI.textContent = 'Aktif ✓';
}else{
badgeAPI.className = 'badge badge-wait';
badgeAPI.textContent = 'Opsiyonel';
}

// Hero durumu
var icon = document.getElementById('statusIcon');
var title = document.getElementById('statusTitle');
var desc = document.getElementById('statusDesc');

if(!pixelId || pixelId.length < 15){
icon.textContent = '📊';
title.textContent = 'Pixel Pasif';
desc.textContent = 'Geçerli Pixel ID girilmedi';
}else if(!settings.active){
icon.textContent = '⏸️';
title.textContent = 'Pixel Hazır';
desc.textContent = 'Aktif edilmeyi bekliyor';
}else if(settings.testMode){
icon.textContent = '🧪';
title.textContent = 'Test Modu';
desc.textContent = 'Test eventleri gönderiliyor';
}else{
icon.textContent = '✅';
title.textContent = 'Pixel Aktif';
desc.textContent = 'Veriler Meta\'ya gönderiliyor';
}
}

function saveAll(){
var pixelId = document.getElementById('pixelId').value.trim();
var accessToken = document.getElementById('accessToken').value.trim();
var testCode = document.getElementById('testCode').value.trim();

if(settings.active && (!pixelId || pixelId.length < 15)){
showToast('❌ Geçerli Pixel ID gerekli!');
return;
}

settings.pixelId = pixelId;
settings.accessToken = accessToken;
settings.testCode = testCode;

localStorage.setItem('meta_pixel_settings', JSON.stringify(settings));
showToast('✓ Ayarlar Kaydedildi');
updateStatus();
initializeMetaPixel();
}

function trackEvent(eventName, parameters = {}){
if(settings.active && settings.pixelId && settings.events.indexOf(eventName) > -1){
fbq('track', eventName, parameters);
console.log('Meta Event tracked:', eventName, parameters);
}
}

// Global fonksiyonlar - diğer sayfalarda kullanılabilir
window.trackMetaPageView = function(){
trackEvent('PageView');
};

window.trackMetaViewContent = function(contentId, contentType, value, currency = 'TRY'){
trackEvent('ViewContent', {
content_ids: [contentId],
content_type: contentType,
value: value,
currency: currency
});
};

window.trackMetaLead = function(value, currency = 'TRY'){
trackEvent('Lead', {
value: value,
currency: currency
});
};

window.trackMetaPurchase = function(value, currency = 'TRY', contentIds = []){
trackEvent('Purchase', {
value: value,
currency: currency,
content_ids: contentIds
});
};

function resetAll(){
if(confirm('Tüm Meta Pixel ayarları sıfırlansın mı?')){
localStorage.removeItem('meta_pixel_settings');
location.reload();
}
}

function showToast(msg){
var t = document.getElementById('toast');
t.textContent = msg;
t.classList.add('show');
setTimeout(function(){ t.classList.remove('show'); }, 2500);
}
</script>
</body>
</html>